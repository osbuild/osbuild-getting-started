digraph src_compile {
    newrank=true;
    subgraph cluster_osbuild_getting_started {
        node [ shape=box; fillcolor=white; style=filled; ]
        style=filled; fillcolor=lightgrey;

        label = "osbuild-\ngetting-started";
        osbuild_getting_started_makefile [
          label = "make\nservice-containers"
          width = 2;
        ];
    }

    subgraph cluster_osbuild {
        node [ shape=box; fillcolor=white; style=filled; ]
        style=filled; fillcolor=lightgrey;

        label = "osbuild\n&nbsp;";
        osbuild_makefile [
          label = "make\ncontainer";
          width = 1.5;
        ];
    }

    subgraph cluster_osbuild_composer {
        node [ shape=box; fillcolor=white; style=filled; ]
        style=filled; fillcolor=lightgrey;

        label = "osbuild-composer\n&nbsp;";
        osbuild_composer_makefile_worker [
          label = "make\ncontainer_worker"
          width = 2;
        ];
        osbuild_composer_makefile_composer [
          label = "make\ncontainer_composer"
          width = 2;
        ];

        osbuild_composer_go [ label = "go code"; ];
    }

    subgraph cluster_image_builder {
        node [ shape=box; fillcolor=white; style=filled; ]
        style=filled; fillcolor=lightgrey;

        label = "image-builder\n&nbsp;";
        image_builder_makefile [
            label = "make\ncontainer"
            width = 1.5;
        ];
        image_builder_go [ label = "go code"; ];
    }

    subgraph cluster_image_builder_frontend {
        node [ shape=box; fillcolor=white; style=filled; ]
        style=filled; fillcolor=lightgrey;

        label = "image-builder-\nfronted";
        image_builder_frontend_makefile [
          label = "make\ncontainer"
          width = 1.5;
        ];
    }
    subgraph cluster_pulp_client {
        node [ shape=box; fillcolor=white; style=filled; ]
        style=filled; fillcolor=lightgrey;

        label = "pulp-client";
        pulp_client_go [
          label = "go code";
          width = 1.5;
        ];
    }
    subgraph cluster_images {
        node [ shape=box; fillcolor=white; style=filled; ]
        style=filled; fillcolor=lightgrey;

        label = "images";
        images_go [label = "go code";];
    }
    subgraph cluster_community_gateway {
        node [ shape=box; fillcolor=white; style=filled; ]
        style=filled; fillcolor=lightgrey;

        label = "community-gateway";
        community_gateway_go [
          label = "go code";
          width = 2;
        ];
    }

    { rank=same;
      osbuild_makefile;
      osbuild_composer_makefile_composer;
      osbuild_composer_makefile_worker;
      image_builder_makefile;
      image_builder_frontend_makefile;

    }
    { rank=same;
        edge [style=dashed];
        image_builder_go -> osbuild_composer_go;
    }
    { rank=same;
        edge [style=dashed; headport=s; tailport=s];
        pulp_client_go;
        images_go;
        community_gateway_go;
    }
    osbuild_composer_go -> pulp_client_go [style=dashed;];
    osbuild_composer_go -> images_go [style=dashed;];
    image_builder_go -> community_gateway_go [style=dashed;];

    osbuild_getting_started_makefile -> osbuild_makefile;
    osbuild_getting_started_makefile -> osbuild_composer_makefile_worker;
    osbuild_getting_started_makefile -> osbuild_composer_makefile_composer;
    osbuild_getting_started_makefile -> image_builder_makefile;
    osbuild_getting_started_makefile -> image_builder_frontend_makefile;
    osbuild_composer_makefile_worker -> osbuild_composer_go [style=dashed];
    osbuild_composer_makefile_composer -> osbuild_composer_go [style=dashed];
    image_builder_makefile -> image_builder_go [style=dashed];



    osbuild_composer_makefile_worker -> osbuild_makefile [style=dashed; headport=s; tailport=s];

}